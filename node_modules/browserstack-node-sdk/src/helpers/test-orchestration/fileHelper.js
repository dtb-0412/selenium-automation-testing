const a129_0x4ac172=a129_0x33eb;function a129_0x33eb(_0x3b4829,_0x5f0fcc){const _0x19af63=a129_0x19af();return a129_0x33eb=function(_0x33ebca,_0x54dc4a){_0x33ebca=_0x33ebca-0x19f;let _0xc9b981=_0x19af63[_0x33ebca];return _0xc9b981;},a129_0x33eb(_0x3b4829,_0x5f0fcc);}function a129_0x19af(){const _0x5b2a78=['readState','existsSync','readFileSync','lockFilePath','FGhpU','iterator','function','error','nbEWU','377711VUNhwA','openSync','stringify','12brMtLy',']\x20Error\x20writing\x20state\x20file:\x20','jvmXG','942138rjkaVc','utf8','acquireLock','releaseLock','uniqueFailedTests','2332472rXVifa','0|3|2|1|4','fullName','97229pFtlOK','RjlZy','from','totalTests','defaultState','1647cKQMBH','3wRpEau','isArray','nyLDr','message','warn',']\x20Could\x20not\x20acquire\x20lock\x20to\x20update\x20API\x20failed\x20count.\x20State\x20may\x20be\x20stale.','recordTestResult','stateFilePath','FailFastFileHelper','18020ymnPLq','add','10aqwZQP','isNewFailure','code','stack','closeSync','MAMxp','7025550ewaWzR',']\x20Error\x20creating\x20state\x20file:\x20',']\x20Could\x20not\x20acquire\x20lock\x20to\x20record\x20test\x20result.\x20State\x20may\x20be\x20stale.','unlinkSync','winstonLogger','has',']\x20Error\x20releasing\x20lock:\x20','EEXIST','lBYXV','failedTests','2mPDBvi','hjtsg','failFastConfig','writeState','1092028gQtNnI','ruWEq','parse'];a129_0x19af=function(){return _0x5b2a78;};return a129_0x19af();}(function(_0x4e7490,_0x239f9c){const _0x419fe5=a129_0x33eb,_0x49c178=_0x4e7490();while(!![]){try{const _0x3cd4b6=parseInt(_0x419fe5(0x1bc))/0x1*(-parseInt(_0x419fe5(0x1ac))/0x2)+parseInt(_0x419fe5(0x1d0))/0x3*(parseInt(_0x419fe5(0x1b0))/0x4)+parseInt(_0x419fe5(0x1db))/0x5*(parseInt(_0x419fe5(0x1c2))/0x6)+parseInt(_0x419fe5(0x1a2))/0x7+-parseInt(_0x419fe5(0x1c7))/0x8+-parseInt(_0x419fe5(0x1cf))/0x9*(parseInt(_0x419fe5(0x1d9))/0xa)+parseInt(_0x419fe5(0x1ca))/0xb*(-parseInt(_0x419fe5(0x1bf))/0xc);if(_0x3cd4b6===_0x239f9c)break;else _0x49c178['push'](_0x49c178['shift']());}catch(_0x2219c5){_0x49c178['push'](_0x49c178['shift']());}}}(a129_0x19af,0x8e4ac));const fs=require('fs'),logger=require('../logger')[a129_0x4ac172(0x1a6)],TAG=a129_0x4ac172(0x1d8);class FileHelper{constructor(_0x588cad,_0x539dc3,_0x1d9bd8,_0x4b1ada){const _0x2b42aa=a129_0x4ac172,_0x154446={};_0x154446[_0x2b42aa(0x1aa)]=_0x2b42aa(0x1c8),_0x154446['MAMxp']=_0x2b42aa(0x1c3);const _0x419ea5=_0x154446,_0x4424fe=_0x419ea5['lBYXV']['split']('|');let _0x3808d0=0x0;while(!![]){switch(_0x4424fe[_0x3808d0++]){case'0':this[_0x2b42aa(0x1ae)]=_0x588cad;continue;case'1':this['defaultState']=_0x4b1ada;continue;case'2':this[_0x2b42aa(0x1b6)]=_0x1d9bd8;continue;case'3':this[_0x2b42aa(0x1d7)]=_0x539dc3;continue;case'4':if(!fs[_0x2b42aa(0x1b4)](this['stateFilePath']))try{fs['writeFileSync'](this[_0x2b42aa(0x1d7)],'{}',_0x419ea5[_0x2b42aa(0x1a1)]);}catch(_0x532cf7){logger['error']('['+TAG+_0x2b42aa(0x1a3)+_0x532cf7[_0x2b42aa(0x1d3)]+'\x20'+_0x532cf7[_0x2b42aa(0x19f)]);}continue;}break;}}async[a129_0x4ac172(0x1c4)](){const _0x4ccc7b=a129_0x4ac172,_0x1d1196={};_0x1d1196[_0x4ccc7b(0x1bb)]=function(_0x3e6a7b,_0x5d5159){return _0x3e6a7b===_0x5d5159;},_0x1d1196['jvmXG']=_0x4ccc7b(0x1a9);const _0x4f22df=_0x1d1196;let _0x2801db;try{return _0x2801db=fs[_0x4ccc7b(0x1bd)](this[_0x4ccc7b(0x1b6)],'wx'),_0x2801db;}catch(_0x592a59){if(_0x4f22df[_0x4ccc7b(0x1bb)](_0x592a59[_0x4ccc7b(0x1dd)],_0x4f22df[_0x4ccc7b(0x1c1)]))return null;throw _0x592a59;}}async[a129_0x4ac172(0x1c5)](_0x36a457){const _0x115e87=a129_0x4ac172;if(_0x36a457)try{fs[_0x115e87(0x1a0)](_0x36a457),fs[_0x115e87(0x1a5)](this[_0x115e87(0x1b6)]);}catch(_0x13fff9){logger[_0x115e87(0x1ba)]('['+TAG+_0x115e87(0x1a8)+_0x13fff9[_0x115e87(0x1d3)]+'\x20'+_0x13fff9[_0x115e87(0x19f)]);}}[a129_0x4ac172(0x1b3)](){const _0xff292a=a129_0x4ac172,_0x4ea0ce={};_0x4ea0ce[_0xff292a(0x1d2)]=_0xff292a(0x1c3);const _0xbbe2d6=_0x4ea0ce;try{const _0x35909c=fs[_0xff292a(0x1b5)](this['stateFilePath'],_0xbbe2d6['nyLDr']);return JSON[_0xff292a(0x1b2)](_0x35909c);}catch(_0x1e370f){return logger[_0xff292a(0x1ba)]('['+TAG+']\x20Error\x20reading\x20state\x20file:\x20'+_0x1e370f['message']+'\x20'+_0x1e370f['stack']),null;}}async[a129_0x4ac172(0x1af)](_0x11ed5a){const _0x1adfb5=a129_0x4ac172,_0x9d260a={..._0x11ed5a,'uniqueFailedTests':Array[_0x1adfb5(0x1d1)](_0x11ed5a[_0x1adfb5(0x1c6)])?_0x11ed5a['uniqueFailedTests']:Array[_0x1adfb5(0x1cc)](_0x11ed5a['uniqueFailedTests']||[])};try{fs['writeFileSync'](this[_0x1adfb5(0x1d7)],JSON[_0x1adfb5(0x1be)](_0x9d260a,null,0x2));}catch(_0x22d59d){logger[_0x1adfb5(0x1ba)]('['+TAG+_0x1adfb5(0x1c0)+_0x22d59d[_0x1adfb5(0x1d3)]+'\x20'+_0x22d59d[_0x1adfb5(0x19f)]);throw _0x22d59d;}}async[a129_0x4ac172(0x1d6)](_0x3ab2d2,_0x47f30c){const _0x1b4c66=a129_0x4ac172,_0x2a7021={};_0x2a7021[_0x1b4c66(0x1b7)]=function(_0x4c9c3d,_0x8420d1){return _0x4c9c3d!==_0x8420d1;},_0x2a7021[_0x1b4c66(0x1cb)]=_0x1b4c66(0x1b9),_0x2a7021['hjtsg']=function(_0xa32d70,_0x95c84d){return _0xa32d70===_0x95c84d;},_0x2a7021[_0x1b4c66(0x1b1)]='failed';const _0x20b5aa=_0x2a7021,_0x1801b9=await this[_0x1b4c66(0x1c4)]();if(!_0x1801b9)return logger[_0x1b4c66(0x1d4)]('['+TAG+_0x1b4c66(0x1a4)),{'newState':this['readState']()||this[_0x1b4c66(0x1ce)],'isNewFailure':![]};try{let _0x543aae=this['readState']();!_0x543aae&&(_0x543aae=JSON[_0x1b4c66(0x1b2)](JSON[_0x1b4c66(0x1be)](this[_0x1b4c66(0x1ce)])));if(!_0x543aae[_0x1b4c66(0x1c6)]||_0x20b5aa[_0x1b4c66(0x1b7)](typeof _0x543aae[_0x1b4c66(0x1c6)][Symbol[_0x1b4c66(0x1b8)]],_0x20b5aa[_0x1b4c66(0x1cb)]))_0x543aae['uniqueFailedTests']=new Set();else Array[_0x1b4c66(0x1d1)](_0x543aae[_0x1b4c66(0x1c6)])&&(_0x543aae[_0x1b4c66(0x1c6)]=new Set(_0x543aae[_0x1b4c66(0x1c6)]));_0x543aae[_0x1b4c66(0x1cd)]=_0x47f30c;let _0x367fd5=![];_0x20b5aa[_0x1b4c66(0x1ad)](_0x3ab2d2['status'],_0x20b5aa['ruWEq'])&&(_0x543aae[_0x1b4c66(0x1ab)]+=0x1,!_0x543aae[_0x1b4c66(0x1c6)][_0x1b4c66(0x1a7)](_0x3ab2d2[_0x1b4c66(0x1c9)])&&(_0x543aae[_0x1b4c66(0x1c6)][_0x1b4c66(0x1da)](_0x3ab2d2['fullName']),_0x367fd5=!![]));await this['writeState'](_0x543aae);const _0x2172f0={};return _0x2172f0['newState']=_0x543aae,_0x2172f0[_0x1b4c66(0x1dc)]=_0x367fd5,_0x2172f0;}finally{await this[_0x1b4c66(0x1c5)](_0x1801b9);}}async['updateAPIFailedCount'](_0x2b65e9){const _0x4f7979=a129_0x4ac172,_0x18d738=await this[_0x4f7979(0x1c4)]();if(!_0x18d738)return logger[_0x4f7979(0x1d4)]('['+TAG+_0x4f7979(0x1d5)),this[_0x4f7979(0x1b3)]()||this[_0x4f7979(0x1ce)];try{let _0x4c5af2=this[_0x4f7979(0x1b3)]();return!_0x4c5af2&&(_0x4c5af2=JSON[_0x4f7979(0x1b2)](JSON[_0x4f7979(0x1be)](this[_0x4f7979(0x1ce)]))),_0x4c5af2['lastAPIFailedCount']=_0x2b65e9,await this[_0x4f7979(0x1af)](_0x4c5af2),_0x4c5af2;}finally{await this['releaseLock'](_0x18d738);}}}module['exports']=FileHelper;