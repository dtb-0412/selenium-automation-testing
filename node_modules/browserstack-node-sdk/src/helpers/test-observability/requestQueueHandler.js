const a124_0x20f20f=a124_0x2feb;function a124_0x1ef0(){const _0x56019c=['QbntO','TEST_REPORTING_ANALYTICS','push','CBTSessionCreated','evbTE','join','YHINW','LogCreated','length','UEPNe','BoFkz','startEventBatchPolling','instance','1580360nmNMZa','../helper','uploadAttachmentUrl','11360525lODyFd','Interval-Queue','getInstance','ZhNmG','leJwT','REMOVING','71396PQeXos','uuid','slice','uXIVZ','6|1|2|4|5|0|3','vxFFw','queue','KhHOB','HRhLm','utf8','shouldProceed','KqxBF','shutdown','screenshotEventUrl','JWnxG','started','add','Batch\x20event\x20length\x20has\x20increased\x20maximum\x20batch\x20size.\x20Sending\x20events..','36590LPvWPx','\x20:\x20','TestRunFinished','TktOL','response','proceedWithData','106314WLrYOu','amoSy','data','1479912TbRukf','byteLength','qfsVn','cxGCf','api/v1/batch','max','16MoRCaR','lkScE','lbNOY','HookRunStarted','../../bin/utils/constants','ShKph','7CKeafg','ZTmQG','pollEventBatchInterval','lXWxV','17865yKYbGP','./utils','removeEventBatchPolling','iyguR','format','EXCEPTION\x20IN\x20','RESETTING','.\x20Request\x20Size\x20-\x20','cgorE','Processing\x20batch\x20events\x20for\x20','eventUrl','message','error','VEgkR','BATCH_EVENT_TYPES','SUmWE','hook_run','kind','wzzLM','JdiXL','includes','event_type','TestRunSkipped','lqpMg','\x20REQUEST\x20TO\x20','Shutting\x20down\x20request\x20batcher\x20with\x20pending\x20uploads\x20still\x20in\x20queue.\x20Remaining\x20uploads\x20','resetEventBatchPolling','batchAndPostEvents','uploadPending','Shutdown-Queue','pYDne','IPAMC','splice','pendingUploads','Exception\x20in\x20logging\x20batch\x20events\x20--\x20','start','upload-attachments','QwuER','Processing\x20events.\x20Queue\x20Length\x20-\x20','\x20event\x20successful\x20for\x20events\x20','456NMXhPq','VXqIw','770lliBoY','Cjyxt','proceedWithUrl','logs','egZaa','bfhhu','map','niYbz'];a124_0x1ef0=function(){return _0x56019c;};return a124_0x1ef0();}function a124_0x2feb(_0x3ce507,_0x306336){const _0x1ef00c=a124_0x1ef0();return a124_0x2feb=function(_0x2feb72,_0x40c261){_0x2feb72=_0x2feb72-0x138;let _0x1414e5=_0x1ef00c[_0x2feb72];return _0x1414e5;},a124_0x2feb(_0x3ce507,_0x306336);}(function(_0x40b2d3,_0x5ebfdb){const _0x101341=a124_0x2feb,_0x3158c3=_0x40b2d3();while(!![]){try{const _0x479d21=parseInt(_0x101341(0x18d))/0x1*(parseInt(_0x101341(0x16c))/0x2)+parseInt(_0x101341(0x184))/0x3+parseInt(_0x101341(0x187))/0x4+parseInt(_0x101341(0x17e))/0x5*(parseInt(_0x101341(0x14c))/0x6)+parseInt(_0x101341(0x193))/0x7*(parseInt(_0x101341(0x163))/0x8)+parseInt(_0x101341(0x197))/0x9*(-parseInt(_0x101341(0x14e))/0xa)+-parseInt(_0x101341(0x166))/0xb;if(_0x479d21===_0x5ebfdb)break;else _0x3158c3['push'](_0x3158c3['shift']());}catch(_0x313cde){_0x3158c3['push'](_0x3158c3['shift']());}}}(a124_0x1ef0,0x84fa5));const {BATCH_SIZE,BATCH_INTERVAL,DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS}=require('./constants'),{nodeRequest,debug,trace,sleep,getDefaultHeaders}=require(a124_0x20f20f(0x198)),{nestedKeyValue}=require(a124_0x20f20f(0x164)),util=require('util'),constants=require(a124_0x20f20f(0x191));class RequestQueueHandler{static ['instance'];[a124_0x20f20f(0x145)]=0x0;constructor(){const _0x275978=a124_0x20f20f,_0x4c542b={};_0x4c542b[_0x275978(0x152)]=_0x275978(0x170),_0x4c542b[_0x275978(0x194)]=_0x275978(0x15d),_0x4c542b['YHINW']=_0x275978(0x159),_0x4c542b[_0x275978(0x19f)]=_0x275978(0x180),_0x4c542b['eGVWX']=_0x275978(0x13a),_0x4c542b[_0x275978(0x1a9)]='HookRunFinished',_0x4c542b['lbNOY']='TestRunStarted',_0x4c542b[_0x275978(0x155)]=_0x275978(0x190),_0x4c542b[_0x275978(0x15f)]=_0x275978(0x18b),_0x4c542b[_0x275978(0x1a6)]='api/v1/screenshots',_0x4c542b['lXWxV']=_0x275978(0x148);const _0x559ae1=_0x4c542b,_0x51eb00=_0x559ae1['egZaa']['split']('|');let _0x2e6607=0x0;while(!![]){switch(_0x51eb00[_0x2e6607++]){case'0':this[_0x275978(0x1a5)]=[_0x559ae1[_0x275978(0x194)],_0x559ae1[_0x275978(0x15c)],_0x559ae1[_0x275978(0x19f)],_0x559ae1['eGVWX'],_0x559ae1[_0x275978(0x1a9)],_0x559ae1[_0x275978(0x18f)],_0x559ae1[_0x275978(0x155)]];continue;case'1':this[_0x275978(0x17b)]=![];continue;case'2':this[_0x275978(0x1a1)]=_0x559ae1[_0x275978(0x15f)];continue;case'3':this[_0x275978(0x195)]=null;continue;case'4':this[_0x275978(0x179)]=_0x559ae1[_0x275978(0x1a6)];continue;case'5':this[_0x275978(0x165)]=_0x559ae1[_0x275978(0x196)];continue;case'6':this[_0x275978(0x172)]=[];continue;}break;}}static[a124_0x20f20f(0x168)](){const _0x42e8a3=a124_0x20f20f;return!RequestQueueHandler[_0x42e8a3(0x162)]&&(RequestQueueHandler[_0x42e8a3(0x162)]=new RequestQueueHandler()),RequestQueueHandler[_0x42e8a3(0x162)];}[a124_0x20f20f(0x147)]=()=>{const _0xd4fa5=a124_0x20f20f;!this['started']&&(this[_0xd4fa5(0x17b)]=!![],this['startEventBatchPolling']());};[a124_0x20f20f(0x17c)]=_0x529d0d=>{const _0x58e00b=a124_0x20f20f,_0x2e0c4d={'JdiXL':function(_0x5eb5a6,_0x4125ca){return _0x5eb5a6===_0x4125ca;},'leJwT':'TEST_SCREENSHOT','SfNWi':function(_0x39eee0,_0x35d4e8){return _0x39eee0>_0x35d4e8;},'ZhNmG':'TEST_ATTACHMENT','qfsVn':function(_0x25eef1,_0x48f4de){return _0x25eef1!==_0x48f4de;},'IPAMC':_0x58e00b(0x180),'ulzuL':function(_0x54beb4,_0x2d78c4){return _0x54beb4(_0x2d78c4);},'vxFFw':_0x58e00b(0x17d)};if(this[_0x58e00b(0x1a5)][_0x58e00b(0x138)](_0x529d0d[_0x58e00b(0x139)])){if(_0x529d0d['logs']&&_0x529d0d[_0x58e00b(0x151)][0x0]&&_0x2e0c4d[_0x58e00b(0x1aa)](_0x529d0d[_0x58e00b(0x151)][0x0][_0x58e00b(0x1a8)],_0x2e0c4d[_0x58e00b(0x16a)])){const _0x4fdc26={};return _0x4fdc26[_0x58e00b(0x176)]=!![],_0x4fdc26[_0x58e00b(0x183)]=[_0x529d0d],_0x4fdc26['proceedWithUrl']=this[_0x58e00b(0x179)],_0x4fdc26;}if(_0x529d0d[_0x58e00b(0x151)]&&_0x2e0c4d['SfNWi'](_0x529d0d[_0x58e00b(0x151)]['length'],0x0)&&_0x2e0c4d[_0x58e00b(0x1aa)](_0x529d0d[_0x58e00b(0x151)][0x0][_0x58e00b(0x1a8)],_0x2e0c4d[_0x58e00b(0x169)])&&_0x2e0c4d[_0x58e00b(0x189)](_0x529d0d[_0x58e00b(0x139)],_0x2e0c4d[_0x58e00b(0x143)])){const _0x3eca85={};return _0x3eca85[_0x58e00b(0x176)]=!![],_0x3eca85[_0x58e00b(0x183)]=[_0x529d0d],_0x3eca85[_0x58e00b(0x150)]=this['uploadAttachmentUrl'],_0x3eca85;}this[_0x58e00b(0x172)][_0x58e00b(0x158)](_0x529d0d);let _0x50f951=null;const _0x43549d=this[_0x58e00b(0x176)]();_0x43549d&&(_0x2e0c4d['ulzuL'](trace,_0x2e0c4d[_0x58e00b(0x171)]),_0x50f951=this[_0x58e00b(0x172)]['slice'](0x0,BATCH_SIZE),this[_0x58e00b(0x172)][_0x58e00b(0x144)](0x0,BATCH_SIZE),this[_0x58e00b(0x13e)]());const _0x58c5e8={};return _0x58c5e8[_0x58e00b(0x176)]=_0x43549d,_0x58c5e8[_0x58e00b(0x183)]=_0x50f951,_0x58c5e8[_0x58e00b(0x150)]=this[_0x58e00b(0x1a1)],_0x58c5e8;}const _0x2e841e={};return _0x2e841e[_0x58e00b(0x176)]=!![],_0x2e841e;};[a124_0x20f20f(0x178)]=async()=>{const _0x220636=a124_0x20f20f,_0x4085ab={'ShKph':'REMOVING','xlPaO':function(_0x2cfe0f,_0x5384bf){return _0x2cfe0f>_0x5384bf;},'evbTE':_0x220636(0x141),'uXIVZ':function(_0xf96e39,_0x2e2e03){return _0xf96e39>_0x2e2e03;},'VEgkR':function(_0xeed8a5,_0x4bb691){return _0xeed8a5(_0x4bb691);}};await this[_0x220636(0x140)](),this[_0x220636(0x199)](_0x4085ab[_0x220636(0x192)]);while(_0x4085ab['xlPaO'](this[_0x220636(0x172)][_0x220636(0x15e)],0x0)){const _0x577155=this[_0x220636(0x172)][_0x220636(0x16e)](0x0,BATCH_SIZE);this[_0x220636(0x172)][_0x220636(0x144)](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x220636(0x1a1)],_0x4085ab[_0x220636(0x15a)],_0x577155);}_0x4085ab[_0x220636(0x16f)](this['pendingUploads'],0x0)&&_0x4085ab[_0x220636(0x1a4)](debug,_0x220636(0x13d)+this[_0x220636(0x145)]);};[a124_0x20f20f(0x13f)]=async(_0x4433cf,_0x1eb5ed,_0x3c3f57)=>{const _0x102476=a124_0x20f20f,_0xe4fb30={'Cjyxt':function(_0x429521,_0x4b2538){return _0x429521(_0x4b2538);},'lkScE':_0x102476(0x175),'Dkyew':function(_0x5bab80,_0x41f9e9){return _0x5bab80(_0x41f9e9);},'lqpMg':function(_0x37fd75){return _0x37fd75();},'iyguR':function(_0xa06c6c,_0x20335f,_0x1a5e47,_0x3dfce5,_0x337d13){return _0xa06c6c(_0x20335f,_0x1a5e47,_0x3dfce5,_0x337d13);},'DlWWO':'POST','TktOL':function(_0xb7a33d,_0x48a4d0){return _0xb7a33d(_0x48a4d0);},'cxGCf':function(_0x3baf2e,_0x3a2ed9){return _0x3baf2e-_0x3a2ed9;},'dcgoP':function(_0x58fa7c,_0x572556){return _0x58fa7c(_0x572556);},'HRhLm':function(_0x476c4e,_0x10afab){return _0x476c4e-_0x10afab;}};let _0x4af83c='';try{_0x4af83c=_0x3c3f57[_0x102476(0x154)](_0x5ae522=>'\x27'+_0x5ae522[_0x102476(0x139)]+'\x27:'+(nestedKeyValue(_0x5ae522,['test_run',_0x102476(0x16d)])||nestedKeyValue(_0x5ae522,[_0x102476(0x1a7),'uuid'])))[_0x102476(0x15b)](','),_0xe4fb30['Cjyxt'](debug,_0x102476(0x1a0)+_0x1eb5ed+_0x102476(0x19e)+Buffer[_0x102476(0x188)](util[_0x102476(0x19b)]('%j',_0x3c3f57),_0xe4fb30[_0x102476(0x18e)])+'\x20bytes.\x20Events\x20are\x20'+_0x4af83c);}catch(_0x5c5411){_0xe4fb30['Dkyew'](debug,_0x102476(0x146)+util[_0x102476(0x19b)](_0x5c5411)+'}');}const _0x3d6add={'headers':_0xe4fb30[_0x102476(0x13b)](getDefaultHeaders)};try{const _0x16c8d9=await _0xe4fb30[_0x102476(0x19a)](nodeRequest,_0xe4fb30['DlWWO'],_0x4433cf,_0x3c3f57,_0x3d6add);if(_0x16c8d9[_0x102476(0x186)][_0x102476(0x1a3)]){const _0x2d72e2={};_0x2d72e2[_0x102476(0x1a2)]=_0x16c8d9[_0x102476(0x186)][_0x102476(0x1a3)];throw _0x2d72e2;}else _0xe4fb30[_0x102476(0x181)](debug,_0x1eb5ed+_0x102476(0x14b)+_0x4af83c+'\x20--\x20'+util[_0x102476(0x19b)]('%j',_0x16c8d9[_0x102476(0x186)])),this[_0x102476(0x145)]=Math[_0x102476(0x18c)](0x0,_0xe4fb30[_0x102476(0x18a)](this[_0x102476(0x145)],_0x3c3f57[_0x102476(0x15e)]));}catch(_0xa1de34){_0xa1de34[_0x102476(0x182)]?_0xe4fb30['dcgoP'](debug,_0x102476(0x19c)+_0x1eb5ed+_0x102476(0x13c)+constants[_0x102476(0x157)]+'\x20:\x20'+_0xa1de34['response']['status']+'\x20'+_0xa1de34[_0x102476(0x182)]['statusText']+'\x20'+util[_0x102476(0x19b)]('%j',_0xa1de34[_0x102476(0x182)])):_0xe4fb30[_0x102476(0x14f)](debug,_0x102476(0x19c)+_0x1eb5ed+_0x102476(0x13c)+constants[_0x102476(0x157)]+_0x102476(0x17f)+(_0xa1de34[_0x102476(0x1a2)]||_0xa1de34)),this[_0x102476(0x145)]=Math[_0x102476(0x18c)](0x0,_0xe4fb30[_0x102476(0x174)](this[_0x102476(0x145)],_0x3c3f57['length']));}};[a124_0x20f20f(0x161)]=()=>{const _0x2bccf6=a124_0x20f20f,_0x2fc665={'KhHOB':function(_0x3fafb1,_0x54c8dd){return _0x3fafb1>_0x54c8dd;},'BoFkz':function(_0x15bf85,_0x54474b){return _0x15bf85(_0x54474b);},'amoSy':_0x2bccf6(0x167),'MzDFo':function(_0x429e98,_0x1e43a8,_0x13097e){return _0x429e98(_0x1e43a8,_0x13097e);}};this[_0x2bccf6(0x195)]=_0x2fc665['MzDFo'](setInterval,async()=>{const _0x1424f4=_0x2bccf6;if(_0x2fc665[_0x1424f4(0x173)](this[_0x1424f4(0x172)][_0x1424f4(0x15e)],0x0)){_0x2fc665[_0x1424f4(0x160)](trace,_0x1424f4(0x14a)+this[_0x1424f4(0x172)][_0x1424f4(0x15e)]);const _0x24add3=this[_0x1424f4(0x172)]['slice'](0x0,BATCH_SIZE);this[_0x1424f4(0x172)]['splice'](0x0,BATCH_SIZE),await this['batchAndPostEvents'](this[_0x1424f4(0x1a1)],_0x2fc665[_0x1424f4(0x185)],_0x24add3),_0x2fc665[_0x1424f4(0x160)](trace,'Remaining\x20Queue\x20Length\x20-\x20'+this[_0x1424f4(0x172)]['length']);}},BATCH_INTERVAL);};[a124_0x20f20f(0x13e)]=()=>{const _0x91568e=a124_0x20f20f,_0x57bbbf={};_0x57bbbf[_0x91568e(0x17a)]=_0x91568e(0x19d);const _0x250a6a=_0x57bbbf;this['removeEventBatchPolling'](_0x250a6a['JWnxG']),this[_0x91568e(0x161)]();};[a124_0x20f20f(0x199)]=_0x2adad1=>{const _0x1ad635=a124_0x20f20f,_0x518cc6={'acbhh':function(_0x255b3b,_0x46a7e8){return _0x255b3b(_0x46a7e8);},'BLZiY':function(_0x1ddd79,_0x49789c){return _0x1ddd79===_0x49789c;},'VXqIw':_0x1ad635(0x16b)};this[_0x1ad635(0x195)]&&(_0x518cc6['acbhh'](clearInterval,this[_0x1ad635(0x195)]),this[_0x1ad635(0x195)]=null,_0x518cc6['BLZiY'](_0x2adad1,_0x518cc6[_0x1ad635(0x14d)])&&(this[_0x1ad635(0x17b)]=![]));};[a124_0x20f20f(0x176)]=()=>{const _0x609a15=a124_0x20f20f,_0x477173={};_0x477173['pYDne']=function(_0x462204,_0x5ac3e1){return _0x462204>=_0x5ac3e1;};const _0x3183d5=_0x477173;return _0x3183d5[_0x609a15(0x142)](this['queue'][_0x609a15(0x15e)],BATCH_SIZE);};async[a124_0x20f20f(0x140)](_0x34fb8d=DEFAULT_WAIT_TIMEOUT_FOR_PENDING_UPLOADS,_0x2009a8=DEFAULT_WAIT_INTERVAL_FOR_PENDING_UPLOADS){const _0x4c00e9=a124_0x20f20f,_0x4145e5={'QwuER':function(_0x47cf17,_0x21c7ca){return _0x47cf17<=_0x21c7ca;},'KqxBF':function(_0x39fd2a,_0x1aa540){return _0x39fd2a<=_0x1aa540;},'bfhhu':function(_0x3889ad,_0x593294){return _0x3889ad(_0x593294);},'QbntO':function(_0x242381,_0x188b91){return _0x242381-_0x188b91;}};if(_0x4145e5[_0x4c00e9(0x149)](this['pendingUploads'],0x0)||_0x4145e5[_0x4c00e9(0x177)](_0x34fb8d,0x0))return;return await _0x4145e5[_0x4c00e9(0x153)](sleep,_0x2009a8),this[_0x4c00e9(0x140)](_0x4145e5[_0x4c00e9(0x156)](_0x34fb8d,_0x2009a8));}}module['exports']=RequestQueueHandler;