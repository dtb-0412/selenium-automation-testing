const a28_0x2e6327=a28_0x4109;function a28_0x1331(){const _0x419ace=['://','857023CHXFjw','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','MzmKi','wvRXJ','654147jBIaoZ','getOidcUrl','StackId','CAPABILITY_NAMED_IAM','waitFor','StackName','-cf','promisifyAll','js-yaml','promise','readFileAsync','OnFailure','26836RCRPzB','2EfsxSl','js-yaml-cloudformation-schema','1703313FkWtXQ','createStack','JrKqN','3376098ziIsfe','xTGPr','browserstack:cluster','10668xksEJu','../config/logger','EYHbq','push','toString','Capabilities','stringify','5951zAHOTW','Properties','1872scqJMf','path','load','BaseResourceName','TKNxZ','Resources','./AWSUtils','XACDO','info','2010-05-15','JXJGT','460RNYCtm','Tags','DELETE','split','PpCxV','join','20kahyUa','jtkTY','browserstack:creationDate','TemplateBody','6372bFtWSu'];a28_0x1331=function(){return _0x419ace;};return a28_0x1331();}function a28_0x4109(_0xc007ec,_0x520049){const _0x13310d=a28_0x1331();return a28_0x4109=function(_0x410994,_0x4596be){_0x410994=_0x410994-0xba;let _0x3b3c9c=_0x13310d[_0x410994];return _0x3b3c9c;},a28_0x4109(_0xc007ec,_0x520049);}(function(_0x306486,_0x1c01fd){const _0x175336=a28_0x4109,_0xb25a1f=_0x306486();while(!![]){try{const _0x5e2e1f=-parseInt(_0x175336(0xee))/0x1*(-parseInt(_0x175336(0xc6))/0x2)+-parseInt(_0x175336(0xf2))/0x3+parseInt(_0x175336(0xc5))/0x4*(-parseInt(_0x175336(0xe2))/0x5)+-parseInt(_0x175336(0xcb))/0x6+parseInt(_0x175336(0xce))/0x7*(parseInt(_0x175336(0xd7))/0x8)+parseInt(_0x175336(0xc8))/0x9*(parseInt(_0x175336(0xe8))/0xa)+parseInt(_0x175336(0xd5))/0xb*(parseInt(_0x175336(0xec))/0xc);if(_0x5e2e1f===_0x1c01fd)break;else _0xb25a1f['push'](_0xb25a1f['shift']());}catch(_0x51eb11){_0xb25a1f['push'](_0xb25a1f['shift']());}}}(a28_0x1331,0x758b8));const fs=require('fs'),path=require(a28_0x2e6327(0xd8)),Promise=require('bluebird'),yaml=require(a28_0x2e6327(0xc1)),{CLOUDFORMATION_SCHEMA}=require(a28_0x2e6327(0xc7)),AWS=require(a28_0x2e6327(0xdd))['awsObj'],AWSUtils=require(a28_0x2e6327(0xdd)),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x2e6327(0xcf));Promise[a28_0x2e6327(0xc0)](fs);const addTags=async(_0x46e7bc,_0x53b428)=>{const _0x25e3d7=a28_0x2e6327;for(const _0x29f9d2 in _0x46e7bc[_0x25e3d7(0xdc)]){_0x46e7bc[_0x25e3d7(0xdc)][_0x29f9d2][_0x25e3d7(0xd6)]&&_0x46e7bc[_0x25e3d7(0xdc)][_0x29f9d2][_0x25e3d7(0xd6)]['Tags']&&_0x46e7bc['Resources'][_0x29f9d2][_0x25e3d7(0xd6)]['Tags'][_0x25e3d7(0xd1)](..._0x53b428);}};exports['createHubHaStack']=async(_0xd7ed9d,_0x7b168b=null)=>{const _0x88e671=a28_0x2e6327,_0x3714e5={'JXJGT':_0x88e671(0xcd),'xTGPr':_0x88e671(0xea),'XACDO':_0x88e671(0xe0),'TKNxZ':'CFTemplates','naMuy':'hub-ha.yaml','EYHbq':'utf-8','HqXTe':function(_0x4cca3c,_0x212972,_0x5491bc){return _0x4cca3c(_0x212972,_0x5491bc);},'qbyaD':_0x88e671(0xed),'JrKqN':_0x88e671(0xe4),'bFHqQ':'VpcId','MzmKi':_0x88e671(0xda),'jtkTY':'ClusterOIDCURL','yPGBV':_0x88e671(0xbc),'PpCxV':_0x88e671(0xef),'wvRXJ':'stackCreateComplete'},_0x216d5a=COMMON_HST_TAGS,_0x5b8fb8={};_0x5b8fb8['Key']=_0x3714e5[_0x88e671(0xe1)],_0x5b8fb8['Value']=_0xd7ed9d,_0x216d5a[_0x88e671(0xd1)](_0x5b8fb8),_0x216d5a['push']({'Key':_0x3714e5[_0x88e671(0xcc)],'Value':new Date()['valueOf']()[_0x88e671(0xd2)]()});const _0x5b641d={};_0x5b641d['apiVersion']=_0x3714e5[_0x88e671(0xde)];const _0x4f6ac1=new AWS['CloudFormation'](_0x5b641d),_0x52989a=await fs[_0x88e671(0xc3)](path[_0x88e671(0xe7)](__dirname,'..',_0x3714e5[_0x88e671(0xdb)],_0x3714e5['naMuy']),_0x3714e5[_0x88e671(0xd0)]),_0x51d782={};_0x51d782['schema']=CLOUDFORMATION_SCHEMA;const _0x1e7938=yaml[_0x88e671(0xd9)](_0x52989a,_0x51d782);await _0x3714e5['HqXTe'](addTags,_0x1e7938,_0x216d5a);const _0x2d62f0=JSON[_0x88e671(0xd4)](_0x1e7938);let _0x2c60ac=await AWSUtils[_0x88e671(0xba)](_0xd7ed9d);_0x2c60ac=_0x2c60ac[_0x88e671(0xe5)](_0x3714e5['qbyaD'])[0x1];const _0x35bf1c={};_0x35bf1c[_0x88e671(0xbe)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0xd7ed9d+_0x88e671(0xbf),_0x35bf1c[_0x88e671(0xc4)]=_0x3714e5[_0x88e671(0xca)],_0x35bf1c[_0x88e671(0xeb)]=_0x2d62f0,_0x35bf1c['Parameters']=[{'ParameterKey':_0x3714e5['bFHqQ'],'ParameterValue':_0x7b168b},{'ParameterKey':_0x3714e5[_0x88e671(0xf0)],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0xd7ed9d},{'ParameterKey':_0x3714e5[_0x88e671(0xe9)],'ParameterValue':_0x2c60ac}],_0x35bf1c[_0x88e671(0xd3)]=[_0x3714e5['yPGBV']],_0x35bf1c[_0x88e671(0xe3)]=_0x216d5a;const _0x22fe0e=_0x35bf1c,_0x45ff1e=await _0x4f6ac1[_0x88e671(0xc9)](_0x22fe0e)['promise']();logger[_0x88e671(0xdf)](_0x3714e5[_0x88e671(0xe6)]);const _0x5d1139={};return _0x5d1139[_0x88e671(0xbe)]=_0x45ff1e[_0x88e671(0xbb)],_0x4f6ac1[_0x88e671(0xbd)](_0x3714e5[_0x88e671(0xf1)],_0x5d1139)[_0x88e671(0xc2)]();};